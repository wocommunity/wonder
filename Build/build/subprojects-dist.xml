<project name="common" default="all" basedir="../..">

    <target name="framework.properties">
        <property name="dist" value="${dist.base}/${project.name}-${project.version}"/>
        <property name="build.root" value="${user.home}/Roots" />
        <property name="project.source.dir" value="${wonder.root}/${project.dir}" />
    </target>

    <target name="copy.framework" depends="framework.properties">
        <property name="framework.name" value="${project}.framework" />

        <copy todir="${dist}/Frameworks/${framework.name}">
            <fileset dir="${build.root}/${framework.name}" />
        </copy>

        <mkdir dir="${build.root}/${framework.name}/WebServerResources" />
        <copy todir="${dist}/WebServerResources/Frameworks/${framework.name}" includeEmptyDirs="false">
            <fileset dir="${build.root}/${framework.name}/WebServerResources" />
        </copy>

        <mkdir dir="${project.source.dir}/Documentation" />
        <copy todir="${dist}/Documentation/Frameworks/${framework.name}" includeEmptyDirs="false">
            <fileset dir="${project.source.dir}/Documentation">
                <exclude name="**/CVS/*" />
            </fileset>
        </copy>

        <mkdir dir="${project.source.dir}/Support" />
        <copy todir="${dist}/Documentation/Frameworks/${framework.name}/Support" includeEmptyDirs="false">
            <fileset dir="${project.source.dir}/Support">
                <exclude name="**/CVS/*" />
            </fileset>
        </copy>

        <echo message="-------------------------------------" />
        <echo message="${framework.name}" />
        <echo message="-------------------------------------" />
    </target>


    <target name="application.properties">
        <property name="dist" value="${dist.base}/${project.name}-${project.version}"/>
        <property name="build.root" value="${user.home}/Roots" />
        <property name="project.source.dir" value="${wonder.root}/${project.dir}" />
    </target>

    <target name="copy.application" depends="application.properties">
        <property name="application.name" value="${project}.woa" />

        <copy todir="${dist}/Applications/${application.name}">
            <fileset dir="${build.root}/${application.name}" />
        </copy>
        
        <chmod file="${dist}/Applications/${application.name}/${project}" perm="ugo+rx"/>

        <mkdir dir="${build.root}/${application.name}/Contents/WebServerResources" />
        <copy todir="${dist}/WebServerResources/${application.name}/Contents/WebServerResources" flatten="true" includeEmptyDirs="false">
            <fileset dir="${build.root}/${application.name}/Contents/WebServerResources" />
        </copy>

        <mkdir dir="${project.source.dir}/Documentation" />
        <copy todir="${dist}/Documentation/Applications/${project}" includeEmptyDirs="false">
            <fileset dir="${project.source.dir}/Documentation">
                <exclude name="**/CVS/*" />
            </fileset>
        </copy>

        <mkdir dir="${project.source.dir}/Support" />
        <copy todir="${dist}/Documentation/Applications/${project}/Support" includeEmptyDirs="false">
            <fileset dir="${project.source.dir}/Support">
                <exclude name="**/CVS/*" />
            </fileset>
        </copy>

        <echo message="-------------------------------------" />
        <echo message="${application.name}" />
        <echo message="-------------------------------------" />
    </target>


     <!-- ExcelGeneration Framework -->
    <target name="ExcelGeneration.framework.all">
        <antcall target="copy.framework" >
            <param name="project" value="ExcelGenerator" />
            <param name="project.dir" value="ExcelGeneration/Frameworks/ExcelGenerator" />
        </antcall>
    </target>

    <!-- ExcelGeneration Example Applications -->
    <target name="ExcelGeneration.example.all">
        <antcall target="copy.application" >
            <param name="project" value="EGSampleApp" />
            <param name="project.dir" value="ExcelGeneration/Examples/EGSampleApp" />
        </antcall>
    </target>

   <!-- DynaReporting Framework -->
    <target name="DynaReporting.framework.all">
        <antcall target="copy.framework" >
            <param name="project" value="DRGrouping" />
            <param name="project.dir" value="DynaReporting/Frameworks/DRGrouping" />
        </antcall>
        <antcall target="copy.framework" >
            <param name="project" value="WRReporting" />
            <param name="project.dir" value="DynaReporting/Frameworks/WRReporting" />
        </antcall>
    </target>

    <!-- DynaReporting Example Applications -->
    <target name="DynaReporting.example.all">
        <antcall target="copy.application" >
            <param name="project" value="DocsByExample" />
            <param name="project.dir" value="DynaReporting/Examples/DocsByExample" />
        </antcall>
        <antcall target="copy.application" >
            <param name="project" value="DRGroupingTest" />
            <param name="project.dir" value="DynaReporting/Examples/DRGroupingTest" />
        </antcall>
        <antcall target="copy.application" >
            <param name="project" value="DynaReporter" />
            <param name="project.dir" value="DynaReporting/Examples/DynaReporter" />
        </antcall>
    </target>

    <!-- WOPayPal -->
    <target name="WOPayPal.all">
        <antcall target="copy.framework" >
            <param name="project" value="WOPayPal" />
            <param name="project.dir" value="PayPal/Frameworks/WOPayPal" />
        </antcall>
    </target>

    <!-- SVGObjects Framework -->
    <target name="SVGObjects.framework.all">
        <antcall target="copy.framework" >
            <param name="project" value="SVGObjects" />
            <param name="project.dir" value="SVGObjects/Frameworks/SVGObjects" />
        </antcall>
    </target>

    <!-- SVGObjects Example Applications -->
    <target name="SVGObjects.example.all">
        <antcall target="copy.application" >
            <param name="project" value="SVGObjectsComponentTour" />
            <param name="project.dir" value="SVGObjects/Examples/ComponentTour" />
        </antcall>
        <antcall target="copy.application" >
            <param name="project" value="SVGObjectsECards" />
            <param name="project.dir" value="SVGObjects/Examples/eCards" />
        </antcall>
        <antcall target="copy.application" >
            <param name="project" value="SVGObjectsEZForms" />
            <param name="project.dir" value="SVGObjects/Examples/EZForms" />
        </antcall>
        <antcall target="copy.application" >
            <param name="project" value="SVGObjectsHello" />
            <param name="project.dir" value="SVGObjects/Examples/Hello" />
        </antcall>
        <antcall target="copy.application" >
            <param name="project" value="SVGObjectsPopIdol" />
            <param name="project.dir" value="SVGObjects/Examples/PopIdol" />
        </antcall>
    </target>
	
    <!-- Validity Framework -->
    <target name="Validity.framework.all">
        <antcall target="copy.framework" >
            <param name="project" value="Validity" />
            <param name="project.dir" value="Validity/Frameworks/Validity" />
        </antcall>
    </target>

    <!-- Validity Application -->
    <target name="Validity.application.all">
        <antcall target="copy.application" >
            <param name="project" value="ValidityModeler" />
            <param name="project.dir" value="Validity/Applications/ValidityModeler" />
        </antcall>
    </target>
	
    <!-- Validity Example Application -->
    <target name="Validity.example.all">
        <antcall target="copy.application" >
            <param name="project" value="ValidityExample" />
            <param name="project.dir" value="Validity/Examples/ValidityExample" />
        </antcall>
    </target>
	
    <target name="Validity.base" depends="Validity.framework.all, Validity.application.all">
        <copy todir="${dist}/Documentation/Applications/Validity" includeEmptyDirs="false">
            <fileset dir="${wonder.root}/Validity/Documentation">
                <exclude name="**/CVS/*" />
            </fileset>
        </copy>
    </target>
    
    <target name="ExcelGeneration.all" depends="ExcelGeneration.framework.all, ExcelGeneration.example.all" />
    <target name="DynaReporting.all" depends="DynaReporting.framework.all, DynaReporting.example.all" />
    <target name="SVGObjects.all" depends="SVGObjects.framework.all, SVGObjects.example.all" />
    <target name="Validity.all" depends="Validity.base, Validity.example.all" />
    <target name="dist.prebuilt" depends="DynaReporting.all, SVGObjects.all, Validity.all, WOPayPal.all, ExcelGeneration.all" />

    <target name="all" depends="dist.prebuilt" />
	
</project>
