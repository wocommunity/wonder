/** INGoogleMaps.js
 * @author Amedeo Mantica
 * @copyright Amedeo Mantica
 * @version 0.2
 * Source available on https://github.com/amedeomantica/INWebTools
 */
function IN_setupGoogleMaps(){var a=in_googleApiKey;var b=document.createElement("script");b.type="text/javascript";b.src=document.location.protocol+"//maps.googleapis.com/maps/api/js?key="+a+"&sensor=false&callback=IN_initializeMaps";document.body.appendChild(b)}window.IN_isIE=false;window.IN_GoogleMaps=Array();var IN_initializeMaps=function(){var a;var b=document.getElementsByTagName("div");for(a=0;a<b.length;a++){if(b[a].className.match(new RegExp("(\\s|^)"+"in_GoogleMap"+"(\\s|$)"))){window.IN_GoogleMaps[b[a].id]=new INGoogleMap(b[a])}}var c=function(a){var b=a.getAttribute("data-in_GoogleMap-id");if(window.IN_GoogleMaps[b]){window.IN_GoogleMaps[b].addMarker(a)}};var d=Array();var e=document.getElementsByTagName("address");for(a=0;a<e.length;a++){if(e[a].className.match(new RegExp("(\\s|^)"+"in_GoogleMapMarker"+"(\\s|$)"))){c(e[a])}}};var INGoogleMap=function(a){var b=Array();b["ROADMAP"]=google.maps.MapTypeId.ROADMAP;b["SATELLITE"]=google.maps.MapTypeId.SATELLITE;b["HYBRID"]=google.maps.MapTypeId.HYBRID;b["TERRAIN"]=google.maps.MapTypeId.TERRAIN;var c={zoom:parseInt(a.getAttribute("data-zoom")),center:g,mapTypeId:b[a.getAttribute("data-type")]};this._map=new google.maps.Map(a,c);var d=this._map;if(a.getAttribute("data-lat")==null||a.getAttribute("data-lng")==null){var e=a.getAttribute("data-address");if(e==null){alert("Unable to load map, there is no Latitude, Longitude or Address specified")}else{var f=new google.maps.Geocoder;f.geocode({address:e},function(a,b){if(b=="OK"){var c=new google.maps.LatLng(a[0].geometry.location.lat(),a[0].geometry.location.lng());d.setCenter(c)}else{alert("Unable to lookup address")}})}}else{var g=new google.maps.LatLng(a.getAttribute("data-lat"),a.getAttribute("data-lng"));d.setCenter(g)}};INGoogleMap.prototype={addMarker:function(a){var b=a.getAttribute("data-title");var c=a.getAttribute("data-draggable")==="true"?true:false;var d=this._map;var e=a.innerHTML;var f=new google.maps.Marker({position:new google.maps.LatLng(0,0),map:this._map,title:b,draggable:c});if(a.getAttribute("data-lat")==null||a.getAttribute("data-lng")==null){var g=a.getAttribute("data-address");if(g==null){alert("Unable to load marker, there is no Latitude, Longitude or Address specified");f.setMap(null);f=null}else{var h=new google.maps.Geocoder;h.geocode({address:g},function(b,c){if(c=="OK"){f.setPosition(b[0].geometry.location);a.setAttribute("data-lng",b[0].geometry.location.lng());a.setAttribute("data-lat",b[0].geometry.location.lat())}})}}else{var i=new google.maps.LatLng(a.getAttribute("data-lat"),a.getAttribute("data-lng"));f.setPosition(i)}if(f!=null){var j;var k;var l=document.getElementsByTagName("input");for(var m=0;m<l.length;m++){if(l[m].className.match(new RegExp("(\\s|^)"+"in_InputField"+"(\\s|$)"))){if(l[m].getAttribute("data-in_bound-object")){boundObjectId=l[m].getAttribute("data-in_bound-object");if(document.getElementById(boundObjectId)){boundObject=document.getElementById(boundObjectId);if(l[m].getAttribute("data-field")==="lng"&&l[m].getAttribute("data-in_bound-object")===a.id){k=l[m];k.value=a.getAttribute("data-lng")}if(l[m].getAttribute("data-field")==="lat"&&l[m].getAttribute("data-in_bound-object")===a.id){j=l[m];j.value=a.getAttribute("data-lat")}}}}}if(c){var n=function(){var b=f.position.lng();var c=f.position.lat();if(k){k.value=b}if(j){j.value=c}a.setAttribute("data-lng",b);a.setAttribute("data-lat",c)};google.maps.event.addListener(f,"drag",n)}else{if(e){if(e!=""){a.infowindow=new google.maps.InfoWindow({content:e});google.maps.event.addListener(f,"click",function(){a.infowindow.open(d,f)})}}}a.lookupAddress=function(a){var b=new google.maps.Geocoder;b.geocode({address:a},function(a,b){if(b=="OK"){f.setPosition(a[0].geometry.location);if(n){n()}d.setCenter(a[0].geometry.location)}})};a.locateOnMap=function(){var b=new google.maps.LatLng(a.getAttribute("data-lat"),a.getAttribute("data-lng"));d.setCenter(b);d.setZoom(18);a.infowindow.open(d,f)}}}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",IN_setupGoogleMaps,false)}else if(document.attachEvent){window.IN_isIE=true;document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){IN_setupGoogleMaps()}})}